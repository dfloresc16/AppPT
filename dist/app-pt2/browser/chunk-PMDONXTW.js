import{a as V}from"./chunk-4XNZD2BV.js";import{d as w,g as F}from"./chunk-NKPXLLZK.js";import{a as M}from"./chunk-64S5AWJR.js";import{a as y,b,c as D,d as L,f as P,g as I,h as T,l as k,m as N,o as B}from"./chunk-Y5P3WVKB.js";import{Cb as A,Db as _,Ia as f,Ka as s,Pa as o,Qa as i,Ra as h,Ua as v,X as g,Za as r,aa as S,d as q,fb as C,va as l,wa as E}from"./chunk-OZKSLEUV.js";var x=q(M());function U(n,c){n&1&&(o(0,"div",13),r(1," El correo es obligatorio. "),i())}function G(n,c){n&1&&(o(0,"div",13),r(1," El correo debe tener dominio @ipn.mx o @alumno.ipn.mx. "),i())}function R(n,c){n&1&&(o(0,"div",13),r(1," La contrase\xF1a es obligatoria. "),i())}function j(n,c){n&1&&(o(0,"div",13),r(1," La contrase\xF1a debe tener m\xE1s de 8 caracteres, una may\xFAscula, un n\xFAmero y un car\xE1cter especial. "),i())}var Y=(()=>{class n{constructor(t){this.fb=t,this.router=g(F),this.authService=g(V),this.loginForm=this.fb.group({email:["",[b.required,this.emailDomainValidator]],password:["",[b.required,this.passwordStrengthValidator]]})}ngOnInit(){console.log("LoginPageComponent loaded")}onSubmit(){if(this.loginForm.valid){let t=this.loginForm.value;this.authService.login(t).subscribe({next:e=>{e.success&&e.body?.token?this.handleLoginSuccess(e.body.token,t):this.showErrorAlert("Error",e.errorMessage||"Error desconocido")},error:e=>{this.showErrorAlert("Error",e.errorMessage||"Error en el servidor")}})}}handleLoginSuccess(t,e){sessionStorage.setItem("access_token",t),sessionStorage.setItem("emailUser",e.email),this.showSuccessAlert("\xA1Login exitoso!","Bienvenido a APP PT"),this.router.navigateByUrl("/dashboard")}redirectToSignUp(){console.log("Redirigiendo a Crear Cuenta..."),this.router.navigate(["/sign-up"])}emailDomainValidator(t){let e=t.value;return/@(?:ipn\.mx|alumno\.ipn\.mx)$/.test(e)?null:{emailDomain:!0}}passwordStrengthValidator(t){let e=t.value,a=/[A-Z]/.test(e),m=/[0-9]/.test(e),d=/[!@#$%^&*(),.?":{}|<>]/.test(e),u=e?.length>8;return a&&m&&d&&u?null:{passwordStrength:!0}}showSuccessAlert(t,e){x.default.fire({icon:"success",title:t,text:e,confirmButtonText:"Aceptar"})}showErrorAlert(t,e){x.default.fire({icon:"error",title:t,text:e,confirmButtonText:"Aceptar"})}static{this.\u0275fac=function(e){return new(e||n)(E(N))}}static{this.\u0275cmp=S({type:n,selectors:[["login-page"]],standalone:!0,features:[C],decls:26,vars:6,consts:[[1,"flex","items-center","justify-center","min-h-screen","bg-[#111827]"],[1,"bg-[#1F2937]","shadow-md","rounded-lg","p-8","max-w-sm","w-full"],[1,"text-2xl","font-bold","text-center","mb-6","text-[#6A5ACD]"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-[#E5E7EB]"],["id","email","type","email","formControlName","email","required","",1,"mt-1","block","w-full","border","border-[#374151]","bg-[#1F2937]","text-white","rounded-md","p-2","focus:ring-[#6A5ACD]","focus:border-[#6A5ACD]"],["class","text-red-500 text-sm",4,"ngIf"],["for","password",1,"block","text-sm","font-medium","text-[#E5E7EB]"],["id","password","type","password","formControlName","password","required","",1,"mt-1","block","w-full","border","border-[#374151]","bg-[#1F2937]","text-white","rounded-md","p-2","focus:ring-[#6A5ACD]","focus:border-[#6A5ACD]"],["type","submit",1,"w-full","bg-[#6A5ACD]","text-white","py-2","px-4","rounded-md","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-[#6A5ACD]","focus:ring-offset-2","disabled:bg-gray-500",3,"disabled"],[1,"text-center","text-sm","text-[#E5E7EB]"],["href","#",1,"text-[#6A5ACD]","hover:underline"],["type","button",1,"w-full","bg-[#1F2937]","text-[#6A5ACD]","py-2","px-4","rounded-md","hover:bg-gray-200","focus:outline-none","focus:ring-2","focus:ring-[#6A5ACD]","focus:ring-offset-2",3,"click"],[1,"text-red-500","text-sm"]],template:function(e,a){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Iniciar Sesi\xF3n"),i(),o(4,"form",3),v("ngSubmit",function(){return a.onSubmit()}),o(5,"div")(6,"label",4),r(7,"Correo Electr\xF3nico"),i(),h(8,"input",5),f(9,U,2,0,"div",6)(10,G,2,0,"div",6),i(),o(11,"div")(12,"label",7),r(13,"Contrase\xF1a"),i(),h(14,"input",8),f(15,R,2,0,"div",6)(16,j,2,0,"div",6),i(),o(17,"button",9),r(18," Iniciar Sesi\xF3n "),i(),o(19,"div",10),r(20," Al continuar, aceptas nuestro "),o(21,"a",11),r(22,"Aviso de Privacidad"),i(),r(23,". "),i(),o(24,"button",12),v("click",function(){return a.redirectToSignUp()}),r(25," Crear Cuenta "),i()()()()),e&2){let m,d,u,p;l(4),s("formGroup",a.loginForm),l(5),s("ngIf",(m=a.loginForm.get("email"))==null?null:m.hasError("required")),l(),s("ngIf",(d=a.loginForm.get("email"))==null?null:d.hasError("emailDomain")),l(5),s("ngIf",(u=a.loginForm.get("password"))==null?null:u.hasError("required")),l(),s("ngIf",(p=a.loginForm.get("password"))==null?null:p.hasError("passwordStrength")),l(),s("disabled",a.loginForm.invalid)}},dependencies:[_,A,B,P,y,D,L,k,I,T,w],encapsulation:2})}}return n})();export{Y as default};
